<!DOCTYPE html>
<html lang="en">
<head>
	<title>GitHub Contributions Graph: Analyzing PageRank &amp; Proving The 6 Handshakes Theory - DevDays 2017</title>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="node_modules/shower-ribbon/styles/screen-16x10.css">
</head>
<body class="shower list">

	<header class="caption">
		<h1>GitHub Contributions Graph: Analyzing PageRank &amp; Proving The 6 Handshakes Theory</h1>
		<p>Vadim Markovtsev, <a href="https://sourced.tech">source{d}</a>.</p>
	</header>

	<style>
		body {
			-webkit-font-smoothing: antialiased;
			-webkit-tap-highlight-color: transparent;
		}
		@media not print {
			.slide {
				color: white;
				background: black;
			}
				.slide h2 {
					color: #8b8d91;
				}
		}
		.slide p {
			line-height: 1.25;
		}
		.slide::after {
			display: none;
		}
		.no-link {
			background: none !important;
		}
		.center {
			display: table;
			margin-left: auto;
			margin-right: auto;
		}
		h2.bottom {
			position: absolute;
			bottom: 50px;
		}
		.important {
			color: red;
		}
		.mono {
			font-family: monospace;
		}
	</style>

	<section class="slide" id="cover">
		<h2>GitHub Contributions Graph: Analyzing PageRank &amp; Proving The 6 Handshakes Theory</h2>
		<p>Vadim Markovtsev, <a class="no-link" href="https://sourced.tech">source{d}</a></p>
		<figure>
			<img class="cover" src="pictures/graph_2048.jpg" alt="GitHub contributions graph - 22M nodes">
		</figure>
		<!--https://goo.gl/NxldTP-->
		<style>
			#cover h2 {
				margin:30px 0 0;
				color:#FFF;
				text-align:center;
				font-size:70px;
			}
			#cover p {
				margin:10px 0 0;
				text-align:center;
				color:#FFF;
				font-style:italic;
				font-size:20px;
			}
				#cover p a {
					color:#FFF;
				}
			#cover img {
				width: 100%;
				object-fit: cover;
			}
		</style>
	</section>

	<section class="slide">
		<h2>Read this on your device</h2>
		<!-- <img> with @media srcset does not work! -->
		<div id="qrcode"></div>
		<style>
			#qrcode {
				width: 350px;
				height: 350px;
				margin-left: auto;
				margin-right: auto;
				display: table;
				background-size: contain;
				background-repeat: no-repeat;
				background-position: center;
				background-image: url("pictures/qrcode_black.svg");
			}
			@media not print {
				#qrcode {
					background-image: url("pictures/qrcode_white.svg");
				}
			}
		</style>
	</section>

	<section class="slide">
		<h2>About me</h2>
		<ul>
			<li>Lead Engineer, Machine Learning @ <a href="https://sourced.tech">source{d}</a></li>
			<li>Education: compiler technologies</li>
			<li>Switched to ML/DS in 2013</li>
			<li>Python, C/C++, Go, HTML5</li>
		</ul>
	</section>	

	<section class="slide">
		<h2>About source{d}</h2>
		<ul>
			<li>&lt; 20 people in Madrid, Spain</li>
			<li>Developed <a href="https://github.com/src-d/go-git">src-d/go-git</a>, Git implementation in Go</li>	
			<li>Fetch all repositories from GitHub/BitBucket/etc.</li>
			<li>Do crazy ML and DS on top of them</li>
			<li>Project <a href="https://doc.bblf.sh/">Babelfish</a> extracts Abstract Syntax Trees from them</li>					
		</ul>
	</section>

	<section class="slide">
		<h2>About this talk</h2>
		<ul>
			<li>Based on the <a href="https://blog.sourced.tech/post/handshakes_pagerank/">blog post</a></li>
			<li>3 parts</li>
			<li>Math inside</li>
			<li>Python code inside</li>
			<li>Data inside</li>
		</ul>
	</section>

	<section class="slide vista ar-2">
		<h2>Part I</h2>
		<style>
			.vista {
				background-size: contain;
				background-repeat: no-repeat;
				background-position: center;
			}
			.vista-cover {
				background-size: cover;
			}
			.ar-2 {
				background-image: url("pictures/armin_ronacher_2_black.png");
			}
			@media not print {
				.ar-2 {
					background-image: url("pictures/armin_ronacher_2_white.png");
				}
			}
			.ar-3 {
				background-image: url("pictures/armin_ronacher_3_black.png");
			}
			@media not print {
				.ar-3 {
					background-image: url("pictures/armin_ronacher_3_white.png");
				}
			}
		</style>
	</section>

	<section class="slide">
		<h2>GitHub in numbers <a id="github-in-numbers-origin" href="https://octoverse.github.com/">octoverse.github.com</a></h2>
		<div id="github-in-numbers">
			<div>
				<div>
					<div class="github-in-numbers-title">5.8M+</div>
					<div class="github-in-numbers-subtitle">active users</div>
					<p>Like <a href="http://github.com/acabunoc" target="_blank">@acabunoc</a>, Lead Developer for Open Source Engagement at the <a href="https://github.com/MozillaFoundation" target="_blank">Mozilla Foundation</a> who is developing new ways to engage contributors on open source projects.</p>
				</div>
				<div>
					<div class="github-in-numbers-title">331k+</div>
					<div class="github-in-numbers-subtitle">active organizations</div>
					<p>Like the <a href="https://github.com/datproject/" target="_blank">Dat project</a> who are working openly to develop a peer to peer tool for distributing datasets in science, journalism and government.</p>
				</div>
			</div>
			<div>
				<div>
					<div class="github-in-numbers-title">19.4M+</div>
					<div class="github-in-numbers-subtitle">active repositories</div>
					<p>Like the <a href="https://github.com/WhiteHouse/source-code-policy" target="_blank">Federal Source Code Policy on GitHub</a> released by <a href="https://github.com/WhiteHouse" target="_blank">The White House</a>, who this year solicited community feedback on GitHub.</p>
				</div>
				<div>
					<div class="github-in-numbers-title">10.7M+</div>
					<div class="github-in-numbers-subtitle">active issues</div>
					<p>Like <a href="https://github.com/golang/go/issues/14595" target="_blank">this one</a> opened in the <a href="https://github.com/golang/go" target="_blank">Go programming language repo</a> that used <a href="https://github.com/blog/2201-making-open-source-data-more-available" target="_blank">open source data</a> on Google’s BiqQuery to help decide whether to add new functionality to a Go standard library.</p>
				</div>
			</div>
		</div>
		<style>
			#github-in-numbers-origin {
				float: right;
			}
			#github-in-numbers {
				display: flex;
				font-family: "Karla", -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Segoe UI", "Oxygen", "Ubuntu", "Cantarell", "Open Sans", sans-serif;
			}
			#github-in-numbers > div {
				display: flex;
				flex-direction: column;
				width: 50%;
			}
			#github-in-numbers > div > div {
				height: 50%;
			}
			#github-in-numbers > div:first-of-type {
				padding-right: 24px;
			}
			.github-in-numbers-title {
				font-size: 3em;
				font-weight: 400;
				line-height: 1;
				margin-bottom: 0;
			}
			.github-in-numbers-subtitle {
				margin-bottom: 12px;
				font-weight: 700;
				line-height: 1;
				font-size: 0.857em;
			}
			#github-in-numbers p {
				font-size: 0.701em;
				line-height: 1.1;
			}
		</style>
	</section>

	<section class="slide">
		<h2>Where to take the data?</h2>
		<p>Commit datasets:</p>
		<ol>
			<li><a href="http://ghtorrent.org/">GHTorrent</a> (145M)</li>
			<li><span class="mono">commits</span> table in <a href="https://bigquery.cloud.google.com/table/bigquery-public-data:github_repos.commits">Google BigQuery</a> - equivalent to GHTorrent</li>
			<li>source{d}'s <a href="https://data.world/vmarkovtsev/452-m-commits-on-github">452M dataset</a></li>
		</ol>
		<p class="important">BigQuery will charge you money.</p>
	</section>

	<section class="slide">
		<h2>Problem</h2>
		<p>There are no GitHub user <-> email associations in both datasets.<p>
		<p class="important">We need to do identity matching.</p>
		<pre>
			<code>mcuadros@gmail.com</code>
			<code>maximo@sourced.tech</code>
			<code>mcuadros@maximos-macbook.local</code>
			<code>mcuadros@maximos-mac-pro.local</code>
			<code>root@localhost</code>
		</pre>
	</section>

	<section class="slide">
		<h2>How to build the graph?</h2>
		<ul>
			<li>Binary undirected edges</li>
			<li>Weighted directed edges
				<ul>
					<li>Implies contribution volume estimation</li>
				</ul>
			</li>
		</ul>
		<p>At large scale, it is useless to distinguish developers and repositories.<p>
	</section>	

	<section class="slide">
		<p class="teaser">Binary undirected edges</p>
	</section>

	<style>
		.teaser {
			font-size: 2em;
		}
	</style>

	<section class="slide">
		<h2>Gephi</h2>
		<ul>
			<li><a href="https://gephi.org">gephi.org</a></li>
			<li>Open source, Java</li>
			<li>Most popular graph visualization software, has GUI</li>
			<li>And very... special</li>
			<li class="important">Does not handle millions of nodes</li>
		</ul>
	</section>
	
	<section class="slide vista ar-2">
		<h2>Armin Ronacher,<br>2 levels</h2>
		<p class="graph-notice">Armin is in the center.<br>8k nodes, 11k edges.</p>
	</section>

	<style>
		.graph-notice {
			position: absolute;
    		bottom: 20px;
		}
	</style>

	<section class="slide vista vista-cover ar-3">
		<h2 class="bottom">3 levels</h2>
		<p class="graph-notice">200k nodes, 300k edges.</p>
	</section>

	<section class="slide">
		<h2>Heatmap</h2>
		<p>Color depends on how many hops the dot is distant from the root.</p>
		<img alt="Sequence of 4 circles with increasing redness" src="pictures/heatmap.svg" class="center" id="heatmap">
		<style>
			#heatmap {
				margin-top: 100px;
				width: 500px;
			}
		</style>
	</section>	

	<section class="slide vista vista-cover rp-3">
		<h2 class="bottom">Rob Pike, 3 levels, zoomed</h2>
		<style>
			.rp-3 {
				background-image: url("pictures/rob_pike_3.png");
			}
		</style>
	</section>	

	<section class="slide vista rp-repos">		
	</section>

	<section class="slide">
		<h2>Oops</h2>
		<p>Actually Rob Pike did not contribute to <a href="https://github.com/cmars/oo">cmars/oo</a> and <a href="https://github.com/cmars/tools">cmars/tools</a>.</p>
		<p>Author forgery is perfectly possible on GitHub.</p>
		<style>
			.rp-repos {
				background-image: url("pictures/rob_pike_repos_black.png");
			}
			@media not print {
				.rp-repos {
					background-image: url("pictures/rob_pike_repos_white.png");
				}
			}
		</style>
	</section>

	<section class="slide">
		<p class="teaser">Weighted directed edges</p>
	</section>

	<section class="slide">
		<h2>Adjacency matrix</h2>
		<div id="adj-matrix"></div>
		<p>C<sub>ij</sub> is the number of commits done by developer i to repository j</p>
		<p>C<sub>ij</sub> = C<sub>ji</sub></p>
		<p>Non-zero elements: &lt;10<sup>-7</sup></p>
		<style>
			#adj-matrix {
				width: 400px;
				height: 400px;
				background-size: contain;
				background-repeat: no-repeat;
				background-position: center;
				float: left;
				margin-right: 50px;
				background-image: url("pictures/adj_matrix_black.svg");
			}
			@media not print {
				#adj-matrix {
					background-image: url("pictures/adj_matrix_white.svg");
				}
			}
		</style>
	</section>

	<section class="slide">
		<h2>Adjacency matrix</h2>
		<p>We normalize values in every column.</p>
		<p>$$\sum_i C_{ij}=1$$</p>
		<p class="important">The matrix is no longer symmetric.</p>
		<ul>
			<li>Developer: measure of attention</li>
			<li>Repository: measure if impact</li>
		</ul>
	</section>

	<section class="slide">
		<h2>LargeVis</h2>		
		<ul>
			<li><a href="https://github.com/lferry007/LargeVis">lferry007/LargeVis</a></li>
			<li>C++, Python</li>			
			<li>Handles millions of nodes</li>
			<li class="important">Unmaintained</li>
		</ul>
	</section>

	<section class="slide">
		<h2>LargeVis</h2>		
		<ul>
			<li>Write every non-zero matrix element (edge) to a text file</li>
			<li>Apply LargeVis command-line application</li>
			<li>23M nodes, 28M edges, 32 cores: <64GB RAM, 2 days</li>
			<li>Plot the resulting node coordinates</li>
		</ul>
		<a href="https://drive.google.com/file/d/0B-w8jGUJto0ibmhpQ1JWamh5UVE">Resulting node coordinates - 264MB.</a>
	</section>

	<section class="slide">
		<h2>Problem</h2>		
		<p>How to plot 22,000,000 dots?</p>
		<ul>
			<li>Brute-force scatter plot</li>
			<li>Brute-force scatter plot with semi-transparent dots</li>
			<li>Heatmap density estimatiion
				<ul>
					<li class="mono">numpy.histogram2d + matplotlib.pyplot.imshow</li>
					<li class="mono">matplotlib.pyplot.hexbin</li>
				</ul>
			</li>
		</ul>
		<a href="graph.ipynb">Jupyter notebook.</a>
	</section>

	<section class="slide vista" id="scatter">
		<h2>Brute-force scatter plot</h2>
		<style>	
			#scatter {
				background-image: url("pictures/graph_scatter.png");
			}
		</style>
	</section>

	<section class="slide vista" id="scatter_alpha">
		<h2>&amp; transparency (0.1)</h2>
		<style>	
			#scatter_alpha {
				background-image: url("pictures/graph_scatter_alpha.png");
			}
		</style>
	</section>

	<section class="slide vista" id="histogram2d">
		<h2>Heatmap (log)</h2>
		<style>	
			#histogram2d {
				background-image: url("pictures/graph_histogram2d.png");
			}
		</style>
	</section>

	<section class="slide" id="handshake">
		<div class="vista"></div>
		<h2>Part II</h2>
		<style>
			#handshake > div {
				transform: scaleX(-1);
				position: absolute;
				left: 0;
				top: 0;
				width: 100%;
				height: 100%;
				background-image: url("pictures/handshake_black.svg");
			}
			@media not print {
				#handshake > div {
					background-image: url("pictures/handshake_white.svg");
				}
			}
		</style>
	</section>

	<section class="slide">
		<h2>Statement</h2>
		<p>Given that two developers "know" each other if they contributed to the same project, how far are they from each other on average?</p>
	</section>

	<section class="slide">
		<h2>Plan</h2>
		<ol>
			<li>Find all the <a href="https://en.wikipedia.org/wiki/Connected_component_(graph_theory)">connected components</a>
			of the graph.</li>

			<li>Pick the core component, or simply “the core”. Calculate the size of the
			<a href="https://en.wikipedia.org/wiki/Sampling_(statistics)">representative sample</a>
			of the pairs of nodes.</li>

			<li>Calculate the distances between sampled node pairs.</li>

			<li>Plot the histogram, draw the conclusion.</li>
		</ol>
	</section>

	<div class="progress"></div>

	<script src="node_modules/shower-core/shower.min.js"></script>

	<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"></script>
</body>
</html>
